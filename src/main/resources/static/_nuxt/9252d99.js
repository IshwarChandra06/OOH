(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{506:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return l}));var n=r(73),o=r(0),l=Object(o.i)("v-toolbar__title"),c=Object(o.i)("v-toolbar__items");n.a},549:function(e,t,r){"use strict";var n=r(1),o=(r(32),r(46),r(238),r(11),r(9),r(47),r(105),r(10),r(8),r(12),r(13),r(5)),l=r(90),c=r(104);function d(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function h(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}t.a=Object(o.a)(l.a,Object(c.b)("form")).extend({name:"v-form",provide:function(){return{form:this}},inheritAttrs:!1,props:{disabled:Boolean,lazyValidation:Boolean,readonly:Boolean,value:Boolean},data:function(){return{inputs:[],watchers:[],errorBag:{}}},watch:{errorBag:{handler:function(e){var t=Object.values(e).includes(!0);this.$emit("input",!t)},deep:!0,immediate:!0}},methods:{watchInput:function(input){var e=this,t=function(input){return input.$watch("hasError",(function(t){e.$set(e.errorBag,input._uid,t)}),{immediate:!0})},r={_uid:input._uid,valid:function(){},shouldValidate:function(){}};return this.lazyValidation?r.shouldValidate=input.$watch("shouldValidate",(function(n){n&&(e.errorBag.hasOwnProperty(input._uid)||(r.valid=t(input)))})):r.valid=t(input),r},validate:function(){return 0===this.inputs.filter((function(input){return!input.validate(!0)})).length},reset:function(){this.inputs.forEach((function(input){return input.reset()})),this.resetErrorBag()},resetErrorBag:function(){var e=this;this.lazyValidation&&setTimeout((function(){e.errorBag={}}),0)},resetValidation:function(){this.inputs.forEach((function(input){return input.resetValidation()})),this.resetErrorBag()},register:function(input){this.inputs.push(input),this.watchers.push(this.watchInput(input))},unregister:function(input){var e=this.inputs.find((function(i){return i._uid===input._uid}));if(e){var t=this.watchers.find((function(i){return i._uid===e._uid}));t&&(t.valid(),t.shouldValidate()),this.watchers=this.watchers.filter((function(i){return i._uid!==e._uid})),this.inputs=this.inputs.filter((function(i){return i._uid!==e._uid})),this.$delete(this.errorBag,e._uid)}}},render:function(e){var t=this;return e("form",{staticClass:"v-form",attrs:h({novalidate:!0},this.attrs$),on:{submit:function(e){return t.$emit("submit",e)}}},this.$slots.default)}})},769:function(e,t,r){"use strict";r.r(t);r(10),r(8),r(12),r(9),r(13);var n=r(57),o=r(1),l=(r(29),r(32),r(46),r(190),r(30),r(67),r(319),r(237),r(11),r(68),r(66),r(78));function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function d(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var h={data:function(){return{loading:!1,search:"",valid:!1,dialog:!1,dialogDelete:!1,totalRolesList:null,sortDirection:"asc",roleData:[],expanded:[],singleExpand:!0,itemsPerPageInExpanded:1e3,options:{pageNumber:null,page:1,itemsPerPage:10},headers:[{text:"Actions",value:"actions",sortable:!1},{text:"ID",value:"id",align:"start",sortable:!0},{text:"Name",value:"name"}],headersPriv:[{text:"Page",value:"page"},{text:"Actions",value:"actions"}],pageActions:["add","update","view","delete"],statusList:[{text:"true",value:!0},{text:"false",value:!1}],editedIndex:-1,selectedOrg:{},editedItem:{id:"",action:"",name:"",privileges:""},defaultItem:{id:"",action:"",name:"",privileges:"",organization:{id:""}},tableHeight:"450px",pageNameRules:[function(e){return!!e||"Page is required"}],actionRules:[function(e){return!!e||"Action is required"}]}},created:function(){this.$store.dispatch("privileges/fetchMasterPrivileges"),this.$store.dispatch("roles/fetchRoles"),this.$store.dispatch("organizations/fetchOrganizations")},computed:d(d(d({},Object(l.c)({userPrivileges:function(e){return e.userPrivileges},getMasterPrivileges:function(e){return e.privileges.masterPrivileges},getAllRoles:function(e){return e.roles.roles},getRoleStats:function(e){return e.roles.roleStats},organizationsList:function(e){return e.organizations.organizations}})),Object(l.b)({getOrganizationId:"getOrgId"})),{},{formTitle:function(){return-1===this.editedIndex?"Add New":"Edit Privilege"},getHeaders:function(){if(this.userPrivileges[this.$route.name]&&(this.userPrivileges[this.$route.name].includes("update")||this.userPrivileges[this.$route.name].includes("delete")))return this.headers;var e=Object(n.a)(this.headers);return e.splice(0,1),e}}),mounted:function(){var e=this;window.addEventListener("keyup",(function(t){13===t.keyCode&&e.searchRecord()})),this.tableHeight=window.innerHeight-250},watch:{selectedOrg:function(e){},dialog:function(e){e||this.close()},dialogDelete:function(e){e||this.closeDelete()},options:{handler:function(){this.dispatchUsersFilter()}},deep:!0,getAllRoles:function(e){if(e&&e.length){this.loading=!1,this.roleData=JSON.parse(JSON.stringify(e));for(var i=0;i<this.roleData.length;i++)if(this.roleData[i]){for(var t={},r=0;r<this.roleData[i].privileges.length;r++){var n=this.roleData[i].privileges[r].name.split("_")[0],o=this.roleData[i].privileges[r].name.split("_")[1];t[n]||(t[n]=[]),t[n].push(o)}for(var l in this.roleData[i].privilegesSplit=[],t)this.roleData[i].privilegesSplit.push({page:l,actions:t[l]})}}else this.loading=!1,this.roleData=[]},getRoleStats:function(e){this.totalRolesList=e&&e.total_record||0}},methods:{onSelectOrg:function(){this.selectedOrg&&this.selectedOrg.id&&(this.editedItem.organization=this.selectedOrg,this.$store.dispatch("organizations/fetchOrganizationById",this.selectedOrg.id))},editItem:function(e){this.dialog=!0,this.editedIndex=this.roleData.indexOf(e),delete e.password,this.selectedOrg=e.organization,this.editedItem=Object.assign({},e)},deleteItem:function(e){this.editedIndex=this.roleData.indexOf(e),this.editedItem=Object.assign({},e),this.dialogDelete=!0},deleteItemConfirm:function(){var e=this;this.$store.dispatch("roles/deleteRole",{id:this.editedItem.id}).then((function(){e.$showSuccessToast(e,"Role Deleted")})).catch((function(){e.$showErrorToast(e,"Parameter Error")})),this.closeDelete()},close:function(){var e=this;this.$refs.form.resetValidation(),this.dialog=!1,this.valid=!1,this.$nextTick((function(){e.editedItem=Object.assign({},e.defaultItem),e.selectedOrg={},e.editedIndex=-1}))},closeDelete:function(){var e=this;this.dialogDelete=!1,this.valid=!1,this.$nextTick((function(){e.editedItem=Object.assign({},e.defaultItem),e.editedIndex=-1}))},save:function(){var e=this;this.$refs.form.validate(),-1===this.editedIndex?this.$store.dispatch("roles/addRole",this.editedItem).then((function(){e.close(),e.$showSuccessToast(e,"Role Added Successfully"),e.dispatchUsersFilter()})).catch((function(t){console.error(t.response),t.response&&t.response.data&&t.response.data.data?e.$showErrorToast(e,t.response.data.msg):e.$showErrorToast(e,"Update Failed")})):(console.log(this.editedItem),this.$store.dispatch("roles/updateRole",this.editedItem).then((function(){e.close(),e.$showSuccessToast(e,"Role Updated Successfully"),e.dispatchUsersFilter()})).catch((function(t){console.error(t.response),t.response&&t.response.data&&t.response.data.data?e.$showErrorToast(e,t.response.data.msg):e.$showErrorToast(e,"Update Failed")})))},searchRecord:function(){this.setTableParams();var e={pageNo:this.pageNumber,pageSize:this.itemsPerPage,orgId:this.getOrganizationId};if(this.sort&&(e.sortField=this.sort),this.sortDirection&&(e.sortOrder=this.sortDirection),this.search&&""!==this.search){var t=this.search.split(","),r=t.filter((function(e){return null!=e&&e.trim().length>0}));t=r.map((function(s){return s.trim()})),e.searchData={name:t},this.$store.dispatch("roles/fetchRoles",e)}else this.search="",e.searchData={},this.$store.dispatch("roles/fetchRoles",e)},clearRecord:function(){this.search="",this.dispatchUsersFilter()},setTableParams:function(){var e=this.options,t=e.sortBy,r=(e.sortDesc,e.page),n=e.itemsPerPage;this.pageNumber=r,this.sort=t[0],this.sortDirection="asc",this.itemsPerPage=n},dispatchUsersFilter:function(){this.setTableParams();var e={searchData:this.searchData||{},pageNo:this.pageNumber,pageSize:this.itemsPerPage,orgId:this.orgId};this.sort&&(e.sortField=this.sort),this.sortDirection&&(e.sortOrder=this.sortDirection),this.$store.dispatch("roles/fetchRoles",e).catch((function(e){console.error("errors",e)}))}}},v=r(45),f=r(56),m=r.n(f),O=r(528),P=r(234),w=r(224),_=r(99),x=r(496),y=r(504),D=r(757),I=r(497),$=r(549),j=r(220),k=r(501),R=r(502),V=r(482),S=r(73),E=r(506),component=Object(v.a)(h,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.getHeaders,items:e.roleData,search:e.search,options:e.options,"server-items-length":e.totalRolesList,"footer-props":{"items-per-page-options":[5,10,30,50,100]},loading:e.loading,"loading-text":"Loading... Please wait","sort-by":"id",expanded:e.expanded,"show-expand":"","single-expand":e.singleExpand,height:e.tableHeight},on:{"update:options":function(t){e.options=t},"update:expanded":function(t){e.expanded=t}},scopedSlots:e._u([{key:"top",fn:function(){return[r("v-toolbar",{attrs:{flat:"",color:"primary"}},[r("v-toolbar-title",{staticClass:"white--text"},[e._v("Roles")]),e._v(" "),r("v-spacer"),e._v(" "),r("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search",dark:"",color:"white","single-line":"","hide-details":"",clearable:""},on:{"click:clear":e.clearRecord,"click:append":e.searchRecord},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._v(" "),r("v-spacer"),e._v(" "),e.userPrivileges[e.$route.name]&&e.userPrivileges[e.$route.name].includes("add")?r("v-btn",{staticClass:"my-2",on:{click:function(t){e.dialog=!0}}},[e._v("\n        Add New\n      ")]):e._e(),e._v(" "),r("v-dialog",{attrs:{"max-width":"600px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[r("v-card",[r("v-card-title",[r("span",{staticClass:"headline"},[e._v(e._s(e.formTitle))])]),e._v(" "),r("v-card-text",[r("v-container",[r("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[r("v-row",[void 0!==e.editedItem.name?r("v-col",{attrs:{cols:"12",sm:"6"}},[r("v-text-field",{attrs:{type:"text",label:"Name"},model:{value:e.editedItem.name,callback:function(t){e.$set(e.editedItem,"name",t)},expression:"editedItem.name"}})],1):e._e(),e._v(" "),void 0!==e.editedItem.privileges?r("v-col",{attrs:{cols:"12",sm:"6"}},[r("v-autocomplete",{attrs:{items:e.getMasterPrivileges,"item-text":"name","item-value":"id","return-object":"",required:"",multiple:"",label:"Privileges"},model:{value:e.editedItem.privileges,callback:function(t){e.$set(e.editedItem,"privileges",t)},expression:"editedItem.privileges"}})],1):e._e()],1)],1)],1)],1),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"primary darken-1"},on:{click:e.close}},[e._v(" Cancel ")]),e._v(" "),r("v-btn",{attrs:{color:"primary darken-1",disabled:!e.valid},on:{click:e.save}},[e._v("\n              Save\n            ")])],1)],1)],1),e._v(" "),r("v-dialog",{attrs:{"max-width":"550px"},model:{value:e.dialogDelete,callback:function(t){e.dialogDelete=t},expression:"dialogDelete"}},[r("v-card",[r("v-card-title",{staticClass:"headline"},[e._v("Are you sure you want to delete this Role?")]),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"primary darken-1"},on:{click:e.closeDelete}},[e._v("Cancel")]),e._v(" "),r("v-btn",{attrs:{color:"primary darken-1"},on:{click:e.deleteItemConfirm}},[e._v("OK")]),e._v(" "),r("v-spacer")],1)],1)],1)],1)]},proxy:!0},{key:"expanded-item",fn:function(t){var n=t.headers,o=t.item;return[r("td",{staticClass:"px-0 py-2",attrs:{colspan:n.length}},[r("v-data-table",{attrs:{headers:e.headersPriv,items:o.privilegesSplit,"item-key":"name",elevation:"0","items-per-page":e.itemsPerPageInExpanded,"hide-default-footer":""}})],1)]}},{key:"item.actions",fn:function(t){var n=t.item;return[e.userPrivileges[e.$route.name]&&e.userPrivileges[e.$route.name].includes("update")?r("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editItem(n)}}},[e._v("\n      mdi-pencil\n    ")]):e._e(),e._v(" "),e.userPrivileges[e.$route.name]&&e.userPrivileges[e.$route.name].includes("delete")?r("v-icon",{attrs:{small:""},on:{click:function(t){return e.deleteItem(n)}}},[e._v("\n      mdi-delete\n    ")]):e._e()]}}])})}),[],!1,null,null,null);t.default=component.exports;m()(component,{VAutocomplete:O.a,VBtn:P.a,VCard:w.a,VCardActions:_.a,VCardText:_.c,VCardTitle:_.d,VCol:x.a,VContainer:y.a,VDataTable:D.a,VDialog:I.a,VForm:$.a,VIcon:j.a,VRow:k.a,VSpacer:R.a,VTextField:V.a,VToolbar:S.a,VToolbarTitle:E.b})}}]);